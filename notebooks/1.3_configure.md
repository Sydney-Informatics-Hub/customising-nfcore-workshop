---
title: '**Configuring workflows**'
output:
  html_document:
    toc: false
    toc_float: false
from: markdown+emoji
---

nf-core pipelines follow a set of best practices and standardized conventions. The structure of an nf-core pipeline is designed to be modular, easily customizable, and reproducible. Although you wonâ€™t need to edit the code base to run an nf-core pipeline, having a basic understanding of the repository structure will help you understand how to configure its execution.

# Workflow Configuration

When a workflow is launched, Nextflow will look for configuration files in multiple locations. As each configuration file can contain conflicting settings, the sources are ranked to decide which settings to are applied.

Configuration sources are reported below and listed in order of priority:

1. Parameters specified on the command line (`--something value`)
2. Parameters provided using the `-params-file` option
3. Config file specified using the `-c my_config` option
4. The config file named `nextflow.config` in the current directory
5. The config file named `nextflow.config` in the workflow project directory
6. The config file `$HOME/.nextflow/config`
7. Values defined within the pipeline script itself (e.g., `main.nf`)

Notably, while some of these files are included in the nf-core repository by default (e.g., `nextflow.config`), others are external to the code base and are included using run options (e.g., `-c` and `-params-file`).

# nf-core workflow structure

nf-core pipelines start from a common template and follow the same structure. To make workflows flexible, the parameters used to configure nf-core pipelines are stored in different files in different locations. Although many of these configuration files are loaded automatically at runtime, you can choose to included or excluded others when you execute the workflow.

![](../figs/1.3_structure.excalidraw.png)

## nextflow.config

For nf-core pipelines, the `nextflow.config` contains parameter defaults.

Inside the `nextflow.`config there are also several `includeConfig` statements that are used to specify additional `.config` files from the `conf/` folder. Each additional `.config` file contains information that may be important when you run the workflow:

- `base.config`
  - Loaded by default.
  - Generous resource allocations using labels.
  - Does not specify any method for software management and expects software to be available (or specified elsewhere).
- `igenomes.config`
  - Loaded by default.
  - Default configuration to access AWS iGenomes.
- `modules.config`
  - Loaded by default.
  - Module-specific configuration options (both mandatory or optional).
- `test.config`
  - Only included if specified as a profile.
  - A configuration profile to test the pipeline with a small test dataset.
- `test_full.config`
  - Only included if specified as a profile.
  - A configuration profile to test the pipeline with a full-size test dataset.

## Config profiles

Configuration files can also contain the definition of one or more profiles. A profile is a set of configuration attributes that can be activated when launching a pipeline by using the `-profile` command option.

```bash
nextflow run nf-core<pipeline> -profile <profile>
```

Configuration profiles are defined by using the special scope `profiles` which group the attributes that belong to that profile. Typical profiles used by nf-core workflows include:

- Software management profiles
  - Profiles for the management of software using software management tools. E.g., `docker`, `singularity`, and `conda`.
- Test profiles
  - Profiles to execute the workflow with a standardized set of test data and parameters.

Multiple profiles can be specified in a comma-separated list when you execute your command. The order of profiles is important!

```bash
nextflow run nf-core<pipeline> -profile test,docker
```

Additionally, an `includeConfig` in the `nextflow.config` is used to access custom institutional profiles that have been submitted to the nf-core config repository on GitHub. At run time, nf-core pipelines fetch configuration profiles from the remote configs repository and make them available.

# Custom config and parameter files

::: callout-warning

A `--params-file` must be used to define parameters.

Parameters defined in the parameter block in `custom.config` files **WILL NOT** override defaults in `nextflow.config` for nf-core pipelines.

:::
